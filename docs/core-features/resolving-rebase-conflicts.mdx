---
title: "解决变基冲突"
description: "了解如何在基础分支前进时处理变基冲突，使用手动解决或编程代理自动冲突解决。"
sidebarTitle: "解决变基冲突"
---

## 当您看到"变基冲突"时

点击变基按钮后，如果您的更改与基础分支冲突，任务状态会变为"变基冲突"，并出现冲突解决横幅。

<Frame>
<img src="/images/vk-rebase-conflicts-top.png" alt="显示变基冲突状态和冲突解决选项的任务" />
</Frame>

冲突横幅提供三个选项来解决情况：

<Frame>
<img src="/images/vk-rebase-banner.png" alt="显示三个可用选项的冲突解决横幅" />
</Frame>

- **解决冲突** - 为编程代理自动生成解决说明
- **在编辑器中打开** - 手动编辑冲突文件
- **中止变基** - 取消并返回到之前的状态

## 自动解决冲突

最简单的解决方案是让编程代理自动解决冲突：

1. 从冲突横幅点击**解决冲突**，生成针对您冲突情况的特定说明，并将它们插入到后续消息区域。

2. 查看生成的说明并点击**解决冲突**（发送按钮更改为此）以让代理分析冲突文件并自动完成变基。

<Frame>
<img src="/images/vk-rebase-conflicts-prompt.png" alt="冲突解决横幅，后续字段中有自动生成的说明" />
</Frame>

代理完成解决后，您的任务状态将显示领先 *n* 个提交，并且**合并**按钮再次可用。

## 手动解决（替代方法）

如果您更喜欢手动解决冲突，您有两个选项：

**对于单个文件：** 使用冲突横幅中的**在编辑器中打开**一次编辑一个冲突文件。解决并刷新页面后，您可以再次按下按钮处理下一个文件。

**对于多个文件（推荐）：** 点击任务右上角的三点图标并选择**在 [您的 IDE] 中打开**，在您选择的 IDE 中打开所有工作树文件，在那里您可以一次解决所有冲突。

<Steps>
<Step title="打开您的 IDE">
  点击右上角的三点图标并选择**在 [您的 IDE] 中打开**以访问所有工作树文件，或使用横幅中的**在编辑器中打开**处理单个文件。
</Step>

<Step title="编辑冲突文件">
  解决每个文件中的合并标记：

  ```diff
  <<<<<<< HEAD (your changes)
  function newFeature() {
    return "new implementation";
  }
  =======
  function oldFeature() {
    return "existing implementation";
  }
  >>>>>>> main (base branch changes)
  ```
</Step>

<Step title="继续变基">
  编辑所有冲突后，暂存并继续：

  ```bash
  git add .
  git rebase --continue
  ```
</Step>
</Steps>

<Tip>
自动解决对大多数冲突最有效。仅在需要精确控制合并决策时使用手动解决。
</Tip>

## 中止变基

如果您需要完全取消变基，请点击**中止变基**返回到"需要变基"状态。然后您可以再次尝试变基，或从更新的基础分支创建新的任务尝试。

## 变基到不同的基础分支

如果您已更改任务尝试的基础分支并看到与您的更改无关的提交，您可以使用 `git rebase --onto` 仅将您的工作变基到新基础：

```bash
git rebase <last-commit-before-your-work> --onto <new-base>
```

### 示例场景

您不小心从 `develop` 分支创建了任务尝试，但它应该基于 `main`。在任务设置中将基础分支更改为 `main` 后，您看到来自 `develop` 的提交，但这些不是您工作的一部分：

```bash
# 找到您工作开始之前的最后一个提交（例如，在 git log 中）
# 然后仅将您的提交变基到 main
git rebase 64d504c94d076070d17affd3f84be63b34515445 --onto main
```

此命令获取您的提交（指定提交哈希之后的所有内容）并将它们重放到 `main` 上，排除来自 `develop` 的无关提交。

<Warning>
小心使用 `git rebase --onto`。确保您识别正确的提交哈希——不属于当前任务的最后一个提交。考虑首先创建备份分支：`git branch backup-branch`。
</Warning>
